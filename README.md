# GR2025

## TL;DR
卒業研究用のリポジトリです

## 使用ライブラリ
以下の通りです

| 名前            | バージョンなど |
|:----------------|--------------:|
| Python          |        3.13.3 |
| PyTorch         |   2.7.1+cu118 |
| torchvision     |   2.7.1+cu118 |
| huggingface_hub |        0.33.4 |

## 使用したTransformerモデル
- [`google/vit-base-patch16-224-in21k`](https://huggingface.co/google/vit-base-patch16-224-in21k)

## ハイパーパラメータ調整

### 学習率を調整
- 以下のパラメータは固定
    - バッチサイズ：$16$
    - エポック数：$10$

|  Batch Size |    Epochs |    lr |  Avg Train Loss | Avg Val Loss |  Avg Accuracy |   Avg F1 |
|------------:|----------:|------:|----------------:|-------------:|--------------:|---------:|
|          16 |        10 |  5E-4 |        0.502080 |     0.523871 |      0.835146 | 0.809449 |
|          16 |        10 |  1E-4 |        0.012280 |     0.172215 |      0.967599 | 0.967179 |
|          16 |        10 |  5E-5 |        0.013480 |     0.147662 |      0.969673 | 0.969227 |
|          16 |        10 |  1E-5 |        0.046080 |     0.152933 |      0.965915 | 0.964679 |
|          16 |        10 |  5E-6 |        0.099760 |     0.171331 |      0.958008 | 0.955794 |
|          16 |        10 |  1E-6 |        0.369600 |     0.381893 |      0.908244 | 0.892620 |


### バッチサイズを調整
- 以下のパラメータは固定
    - 学習率：$1 \times 10^{-5}$
    - エポック数：$10$

|  Batch Size |    Epochs |    lr |  Avg Train Loss | Avg Val Loss |  Avg Accuracy |   Avg F1 |
|------------:|----------:|------:|----------------:|-------------:|--------------:|---------:|
|           8 |        10 |  1E-5 |        0.025240 |     0.161946 |      0.967729 | 0.966760 |
|          16 |        10 |  1E-5 |        0.046080 |     0.152933 |      0.965915 | 0.964679 |
|          32 |        10 |  1E-5 |        0.095940 |     0.158786 |      0.962026 | 0.959895 |


### エポック数を調整
- 以下のパラメータは固定
    - 学習率：$1 \times 10^{-5}$
    - バッチサイズ：$16$

|  Batch Size |    Epochs |    lr |  Avg Train Loss | Avg Val Loss |  Avg Accuracy |   Avg F1 |
|------------:|----------:|------:|----------------:|-------------:|--------------:|---------:|
|          16 |        10 |  1E-5 |        0.046080 |     0.152933 |      0.965915 | 0.964679 |
|          16 |        20 |  1E-5 |        0.016600 |     0.169563 |      0.969284 | 0.968568 |
|          16 |        30 |  1E-5 |        0.010900 |     0.185510 |      0.968636 | 0.968025 |



## 更新履歴

### 2025/07/20
- 機械学習の基礎を学びました
- HuggingFaceの `datasets` を用いてMNISTデータセットを学習させました
- Google Colab でも動かしてみましたが、無料枠では限界を感じました
  - 研究するなら金払え！！！！
  - <img width="288" height="215" alt="{5880D043-7314-4998-8BEC-A9F857CCEFBB}" src="https://github.com/user-attachments/assets/e572d875-77d1-4b93-98cf-efae1a635d5a" />
- PyTorch を動かすのにPythonのバージョンをあれこれ揃えないといけない

### 2025/07/21
- 昨日、HuggingFaceおよびPyTorchを用いた学習方法を学んだので、少し動かしてみた
- MNISTの学習に4時間程度要しました
  - epoch: 3
  - batch size: 64
- 手書き文字認識する簡単なWebアプリを実装
- Flask で作成、`app.py` にて実行可能

### 2025/10/29
- 一旦ハイパーパラメータの調整をする方針で進める
- 埋め込みベクトルを取得して画像生成する手法もやる
